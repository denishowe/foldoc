<!DOCTYPE html>
<!-- Firefox createRadialGradient leaks memory -->
<html>
<head>
<title>Leak</title>
<meta charset="UTF-8">
</head>
<body>
<canvas id="c"></canvas>
<script>
const canvas = document.getElementById('c');
const m = 300;
canvas.width = 2 * m;
canvas.height = 2 * m;
const ctx = canvas.getContext('2d');
const a = 2 * Math.PI;

function f() {
	for (let i = 1000; i--; ) {
		const g = ctx.createRadialGradient(m, m, 0, m, m, m);
		g.addColorStop(0, "blue");
		g.addColorStop(1, "white");
		ctx.fillStyle = g;
		ctx.beginPath();
		ctx.arc(m, m, m, 0, a);
		ctx.fill();
		ctx.closePath();
	}
	setTimeout(f, 0);
}
f();
</script>
</body>
</html>
